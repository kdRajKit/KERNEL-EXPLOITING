import re

with open('shellcode_disasm.txt', 'r') as f:
    lines = f.readlines()

shellcode = ""
for line in lines:
    match = re.match(r'^\s*([0-9a-f]+):\s*((?:[0-9a-f]{2} )+)', line)
    if match:
        bytes = match.group(2).strip().split()
        for byte in bytes:
            shellcode += f"\\x{byte}"

print(shellcode)

with open('shellcode_bytes.txt', 'w') as f:
    f.write(shellcode)

